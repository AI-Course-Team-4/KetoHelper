# ğŸ¯ MVP í¬ë¡¤ë§ ì‹œìŠ¤í…œ í†µí•© ì„¤ì •

app:
  name: "Restaurant Crawler MVP"
  version: "1.0.0"
  debug: false
  
# ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • (Supabase)
database:
  # Supabase ì—°ê²° ì •ë³´
  supabase_url: "${SUPABASE_URL}"
  supabase_anon_key: "${SUPABASE_ANON_KEY}"
  supabase_service_key: "${SUPABASE_SERVICE_KEY}"
  
  # PostgreSQL ì§ì ‘ ì—°ê²° (Supabaseì—ì„œ ì œê³µ)
  host: "${DB_HOST}"
  port: 5432
  name: "${DB_NAME:postgres}"
  user: "${DB_USER:postgres}"
  password: "${DB_PASSWORD}"
  
  # ì—°ê²° í’€ ì„¤ì •
  pool_size: 5
  max_overflow: 10
  timeout: 30
  
  # Supabase ì„¤ì •
  enable_realtime: true
  enable_rest_api: true

# ğŸ•·ï¸ í¬ë¡¤ë§ ì„¤ì •  
crawler:
  # ì„±ëŠ¥ ì œí•œ
  max_concurrent_tabs: 3
  default_timeout: 10
  page_timeout: 15
  
  # ì†ë„ ì œí•œ (ì‚¬ì´íŠ¸ë³„ QPS)
  rate_limits:
    siksin: 0.5          # 0.5 QPS - ì•ˆì „í•œ ì†ë„
    diningcode: 0.5
    mangoplate: 0.3
    default: 0.3
    
  # ì¬ì‹œë„ ì •ì±…
  retry:
    max_attempts: 3
    backoff_multiplier: 2
    initial_delay: 5     # ì´ˆê¸° 5ì´ˆ ëŒ€ê¸°
    max_delay: 300       # ìµœëŒ€ 5ë¶„ ëŒ€ê¸°
    
  # User-Agent ë¡œí…Œì´ì…˜ (ì°¨ë‹¨ ë°©ì§€)
  user_agents:
    - "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
    - "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
    - "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
    
  # Playwright ì˜µì…˜
  playwright:
    headless: true
    slow_mo: 1000        # 1ì´ˆ ìŠ¬ë¡œìš° ëª¨ì…˜ (ì°¨ë‹¨ ë°©ì§€)
    viewport:
      width: 1280
      height: 720

# ğŸ“Š ë°ì´í„° ê²€ì¦ ì„¤ì •
validation:
  # í•„ìˆ˜ í•„ë“œ (restaurant)
  restaurant_required_fields:
    - "name"
    - "lat" 
    - "lng"
    
  # í•„ìˆ˜ í•„ë“œ (menu)  
  menu_required_fields:
    - "name"
    
  # ë°ì´í„° í’ˆì§ˆ ê¸°ì¤€
  quality_thresholds:
    min_quality_score: 50    # ìµœì†Œ í’ˆì§ˆ ì ìˆ˜
    min_confidence: 0.3      # ìµœì†Œ ì‹ ë¢°ë„
    
  # ì¢Œí‘œ ê²€ì¦ (ì„œìš¸ì‹œ ê²½ê³„)
  geo_bounds:
    lat_min: 37.4
    lat_max: 37.7  
    lng_min: 126.8
    lng_max: 127.2
    
  # ê°€ê²© ê²€ì¦
  price_bounds:
    min: 1000           # ìµœì†Œ ê°€ê²© 1,000ì›
    max: 100000         # ìµœëŒ€ ê°€ê²© 100,000ì›
    
  # í…ìŠ¤íŠ¸ ê¸¸ì´ ì œí•œ
  text_limits:
    restaurant_name_max: 50
    menu_name_max: 100
    address_max: 200
    phone_pattern: "^\\d{2,3}-\\d{3,4}-\\d{4}$"

# ğŸš¨ ì—ëŸ¬ ì²˜ë¦¬ ì„¤ì •
error_handling:
  # HTTP ì—ëŸ¬ ë§¤í•‘
  http_errors:
    403: "rate_limit"     # 403 -> ì†ë„ ì œí•œ
    429: "rate_limit"     # 429 -> ì†ë„ ì œí•œ  
    5xx: "server_error"   # 5xx -> ì„œë²„ ì˜¤ë¥˜
    timeout: "timeout"    # íƒ€ì„ì•„ì›ƒ
    
  # ì°¨ë‹¨ ê°ì§€ í‚¤ì›Œë“œ
  blocking_indicators:
    - "reCAPTCHA"
    - "Access Denied"
    - "Rate Limit Exceeded"
    - "captcha"
    - "bot"
    - "robot"
    
  # ìë™ ê°ì† ì„¤ì •
  rate_limit_response:
    reduce_qps_factor: 0.5  # QPS 50% ê°ì†
    backoff_time: 60        # 60ì´ˆ ëŒ€ê¸°
    max_backoff: 600        # ìµœëŒ€ 10ë¶„ ëŒ€ê¸°
    
  # ì¬ì‹œë„ ê°€ëŠ¥í•œ ì—ëŸ¬
  retryable_errors:
    - "timeout"
    - "connection_error"
    - "server_error"
    - "rate_limit"

# ğŸ“ ë¡œê¹… ì„¤ì •
logging:
  level: "INFO"
  format: "[{time:YYYY-MM-DD HH:mm:ss}] {level} - {name} - {message}"
  
  # ë¡œê·¸ íŒŒì¼ ì„¤ì •
  files:
    main: "logs/crawler.log"
    error: "logs/error.log" 
    access: "logs/access.log"
    
  # ë¡œê·¸ ë¡œí…Œì´ì…˜
  rotation:
    size: "10 MB"
    retention: "7 days"
    backup_count: 5
    
  # ë¡œê·¸ ë ˆë²¨ë³„ ì„¤ì •
  levels:
    root: "INFO"
    crawler: "DEBUG"
    database: "INFO"
    parser: "DEBUG"

# ğŸ” ëª¨ë‹ˆí„°ë§ ì„¤ì •  
monitoring:
  # ë©”íŠ¸ë¦­ ìˆ˜ì§‘ í™œì„±í™”
  metrics:
    success_rate: true
    response_time: true
    error_rate: true
    queue_size: true
    data_quality: true
    
  # ì•Œë¦¼ ì„ê³„ê°’
  alerts:
    success_rate_min: 0.8    # ì„±ê³µë¥  80% ì´í•˜ ì‹œ ì•Œë¦¼
    error_rate_max: 0.2      # ì—ëŸ¬ìœ¨ 20% ì´ìƒ ì‹œ ì•Œë¦¼
    queue_size_max: 100      # í í¬ê¸° 100 ì´ìƒ ì‹œ ì•Œë¦¼
    response_time_max: 30    # ì‘ë‹µì‹œê°„ 30ì´ˆ ì´ìƒ ì‹œ ì•Œë¦¼
    
  # í†µê³„ ìˆ˜ì§‘ ê°„ê²©
  collection_interval: 300   # 5ë¶„ë§ˆë‹¤ ìˆ˜ì§‘

# ğŸ¯ í¬ë¡¤ë§ ì „ëµ
strategy:
  # ê²€ìƒ‰ ì „ëµ
  search:
    max_pages: 5           # ê²€ìƒ‰ ê²°ê³¼ ìµœëŒ€ í˜ì´ì§€ ìˆ˜
    results_per_page: 20   # í˜ì´ì§€ë‹¹ ê²°ê³¼ ìˆ˜
    min_results: 1         # ìµœì†Œ ê²°ê³¼ ìˆ˜
    
  # ë°°ì¹˜ í¬ê¸°
  batch_size: 10           # í•œ ë²ˆì— ì²˜ë¦¬í•  ì‹ë‹¹ ìˆ˜
  
  # ì¤‘ë³µ ì œê±° ì „ëµ
  deduplication:
    name_similarity: 0.8   # ì´ë¦„ ìœ ì‚¬ë„ ì„ê³„ê°’
    address_radius: 50     # ì£¼ì†Œ ë°˜ê²½ 50m
    phone_exact: true      # ì „í™”ë²ˆí˜¸ ì •í™• ë§¤ì¹˜
    
# ğŸ”§ ê°œë°œì ì„¤ì •
development:
  # í…ŒìŠ¤íŠ¸ ëª¨ë“œ
  test_mode: false
  test_data_limit: 10
  
  # ë””ë²„ê·¸ ì˜µì…˜
  debug:
    save_raw_html: true    # ì›ë³¸ HTML ì €ì¥
    log_requests: true     # ìš”ì²­ ë¡œê¹…
    screenshot_on_error: false  # ì—ëŸ¬ ì‹œ ìŠ¤í¬ë¦°ìƒ·
    
  # ê°œë°œì ë„êµ¬
  tools:
    enable_profiling: false
    enable_memory_tracking: false