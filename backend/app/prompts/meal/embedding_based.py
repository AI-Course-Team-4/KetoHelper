"""
임베딩 데이터 기반 식단 생성 프롬프트
실제 레시피 데이터를 우선적으로 활용하는 프롬프트들
"""

# 임베딩 데이터 기반 식단표 생성 프롬프트
EMBEDDING_MEAL_PLAN_PROMPT = """
당신은 키토 식단 전문가입니다. 임베딩된 레시피 데이터를 바탕으로 {days}일간의 키토 식단표를 생성해주세요.

제약 조건: {constraints}

## 📋 식단표 생성 가이드

### 🍽️ 식사 타입별 추천 키워드
**아침 (Breakfast):**
- 계란, 베이컨, 아보카도, 치즈, 버터
- 스크램블, 오믈렛, 구이, 볶음

**점심 (Lunch):**
- 샐러드, 구이, 볶음, 스테이크, 생선
- 그린, 시저, 코브, 그릴

**저녁 (Dinner):**
- 고기, 생선, 찜, 구이, 스튜
- 삼겹살, 목살, 연어, 참치, 새우

**간식 (Snack):**
- 견과류, 치즈, 올리브, 베리
- 아몬드, 호두, 피칸, 블루치즈

### 🔍 검색 전략
1. **다양성 확보**: 같은 재료 반복 최소화
2. **영양 균형**: 단백질, 지방, 탄수화물 고려
3. **조리 난이도**: 간단한 것부터 복잡한 것까지
4. **사용자 선호도**: 알레르기, 비선호 재료 고려

### 📊 응답 형식
각 식사별로 다음 정보를 포함해주세요:
- 레시피 제목
- 주요 재료
- 조리 방법 (간단히)
- 예상 영양 정보
- 키토 친화도 점수

### ⚠️ 주의사항
- 탄수화물 20g 이하 유지
- 충분한 지방 섭취 (70-80%)
- 적정 단백질 (15-25%)
- 사용자 제약사항 준수
"""

# AI 구조 + 임베딩 데이터 조합 프롬프트
AI_STRUCTURE_EMBEDDING_PROMPT = """
당신은 키토 식단 전문가입니다. AI가 생성한 식단 구조를 바탕으로 임베딩된 레시피 데이터에서 구체적인 메뉴를 찾아주세요.

AI 구조: {ai_structure}
제약 조건: {constraints}

## 🎯 임베딩 데이터 검색 가이드

### 📝 검색 쿼리 생성 전략
1. **AI 구조 파싱**: 각 슬롯의 meal_type 추출
2. **키워드 확장**: 관련 키워드 추가
3. **사용자 컨텍스트**: 제약 조건 반영
4. **유사도 임계값**: 0.7 이상 결과만 선택

### 🔍 슬롯별 검색 예시
**아침 (breakfast):**
- AI 구조: "계란 요리" → 검색: "계란 스크램블 키토 아침"
- AI 구조: "베이컨 요리" → 검색: "베이컨 구이 키토 브런치"

**점심 (lunch):**
- AI 구조: "샐러드" → 검색: "키토 그린 샐러드 점심"
- AI 구조: "구이" → 검색: "키토 스테이크 구이 점심"

**저녁 (dinner):**
- AI 구조: "고기 요리" → 검색: "키토 삼겹살 구이 저녁"
- AI 구조: "생선 요리" → 검색: "키토 연어 구이 저녁"

### 📊 결과 평가 기준
1. **유사도 점수**: 0.7 이상
2. **제약 조건 준수**: 알레르기, 비선호 재료 제외
3. **영양 균형**: 탄수화물 20g 이하
4. **다양성**: 같은 재료 반복 최소화

### ⚠️ 폴백 전략
임베딩 데이터에서 적절한 결과를 찾지 못한 경우:
1. 키워드 단순화
2. 검색 범위 확대
3. LLM 생성으로 전환
"""

# 임베딩 데이터 검색 최적화 프롬프트
EMBEDDING_SEARCH_OPTIMIZATION_PROMPT = """
임베딩된 레시피 데이터에서 최적의 검색 결과를 찾기 위한 쿼리 최적화 가이드입니다.

원본 요청: {original_query}
사용자 프로필: {user_profile}
제약 조건: {constraints}

## 🔍 쿼리 최적화 전략

### 📝 키워드 확장
**기본 키워드:** {original_query}
**확장 키워드:**
- 키토 관련: "키토", "저탄수화물", "고지방"
- 조리법: "구이", "볶음", "찜", "스튜"
- 재료: 관련 재료명들
- 시간대: "아침", "점심", "저녁", "간식"

### 🎯 검색 우선순위
1. **정확 매칭**: 원본 쿼리와 정확히 일치
2. **의미 매칭**: 유사한 의미의 키워드
3. **카테고리 매칭**: 같은 카테고리 내 다른 옵션
4. **폴백 매칭**: 기본적인 키토 레시피

### 📊 결과 필터링
**포함해야 할 것:**
- 탄수화물 20g 이하
- 사용자 알레르기 성분 없음
- 사용자 비선호 재료 없음
- 유사도 0.7 이상

**제외해야 할 것:**
- 고탄수화물 레시피
- 알레르기 유발 성분
- 비선호 재료 포함
- 유사도 0.5 미만

### 🔄 재시도 전략
검색 결과가 부족한 경우:
1. 키워드 단순화
2. 검색 범위 확대
3. 시간대 키워드 제거
4. 기본 키토 키워드만 사용
"""

# 임베딩 데이터 기반 레시피 추천 프롬프트
EMBEDDING_RECIPE_RECOMMENDATION_PROMPT = """
임베딩된 레시피 데이터를 바탕으로 사용자에게 최적의 레시피를 추천해주세요.

검색 결과: {search_results}
사용자 프로필: {user_profile}
제약 조건: {constraints}

## 🎯 추천 기준

### 📊 점수 계산
**기본 점수 (50점):**
- 유사도 점수 × 50

**프로필 매칭 보너스 (30점):**
- 알레르기 성분 없음: +15점
- 비선호 재료 없음: +15점

**영양 균형 보너스 (20점):**
- 탄수화물 20g 이하: +10점
- 적정 지방 함량: +10점

### 🏆 최종 추천
1. **최고 점수 레시피**: 가장 높은 점수
2. **대안 레시피**: 2-3위 옵션들
3. **폴백 레시피**: 기본적인 키토 레시피

### 📝 추천 이유
각 레시피에 대해 다음을 설명해주세요:
- 왜 이 레시피를 추천하는가?
- 사용자 프로필과 어떻게 맞는가?
- 영양적으로 어떤 장점이 있는가?
- 조리 시 주의사항은?

### ⚠️ 주의사항
- 사용자 제약사항을 반드시 고려
- 알레르기 성분이 포함된 레시피는 절대 추천하지 않음
- 비선호 재료가 포함된 레시피는 대안 제시
- 탄수화물 함량이 높은 레시피는 수정 방안 제시
"""

# AI 기반 검색 쿼리 생성 프롬프트
AI_SEARCH_QUERY_GENERATION_PROMPT = """
당신은 키토 식단 전문가이자 검색 쿼리 최적화 전문가입니다. 
임베딩된 레시피 데이터베이스에서 최적의 검색 결과를 얻기 위한 검색 쿼리를 생성해주세요.

## 📋 요청 정보
- **식사 타입**: {meal_slot} ({meal_type})
- **사용자 제약 조건**: {constraints}
- **이미 사용된 레시피**: {used_recipes}
- **검색 전략**: {search_strategy}

## 🎯 검색 쿼리 생성 가이드

### 📝 쿼리 구성 요소
1. **핵심 키워드**: 식사 타입과 관련된 주요 재료/조리법
2. **보조 키워드**: 관련 재료, 조리법, 시간대
3. **키토 키워드**: "키토", "저탄수화물", "고지방"
4. **제외 키워드**: 사용자 알레르기/비선호 재료

### 🔍 검색 전략별 접근법

**전략 1: 기본 키워드 조합**
- 식사 타입 + 주요 재료 + 키토
- 예: "아침 계란 베이컨 키토"

**전략 2: 조리법 중심**
- 조리법 + 식사 타입 + 키토  
- 예: "스크램블 아침 키토"

**전략 3: 재료 중심**
- 특정 재료 + 식사 타입 + 키토
- 예: "아보카도 아침 키토"

**전략 4: 시간대 중심**
- 시간대 + 식사 타입 + 키토
- 예: "브런치 아침 키토"

### 📊 응답 형식
다음 JSON 형태로 응답해주세요:
```json
{
  "primary_query": "주요 검색 쿼리",
  "alternative_queries": [
    "대안 쿼리 1",
    "대안 쿼리 2", 
    "대안 쿼리 3"
  ],
  "excluded_keywords": ["제외할 키워드들"],
  "search_strategy": "사용된 검색 전략",
  "reasoning": "쿼리 생성 이유"
}
```

### ⚠️ 주의사항
- 이미 사용된 레시피와 중복되지 않도록 고려
- 사용자 제약 조건을 반드시 반영
- 검색 성공률을 높이기 위한 다양한 접근법 제시
- 키토 식단에 적합한 키워드 우선 사용
"""

# AI 기반 식사별 검색 전략 생성 프롬프트
AI_MEAL_SEARCH_STRATEGY_PROMPT = """
당신은 키토 식단 전문가입니다. 
{days}일간의 키토 식단표를 위해 각 식사별로 최적의 검색 전략을 생성해주세요.

## 📋 요청 정보
- **생성 일수**: {days}일
- **사용자 제약 조건**: {constraints}
- **다양성 요구사항**: 매일 다른 레시피, 중복 최소화

## 🍽️ 식사별 검색 전략

### 🌅 아침 (Breakfast)
**주요 키워드**: 계란, 베이컨, 아보카도, 치즈, 버터
**조리법**: 스크램블, 구이, 볶음, 오믈렛
**시간대**: 아침, 브런치, 모닝

### 🍽️ 점심 (Lunch)  
**주요 키워드**: 샐러드, 구이, 볶음, 스테이크, 생선
**조리법**: 그릴, 찜, 스튜, 볶음
**시간대**: 점심, 런치, 미들데이

### 🌙 저녁 (Dinner)
**주요 키워드**: 고기, 생선, 찜, 구이, 스튜
**조리법**: 구이, 찜, 스튜, 그릴
**시간대**: 저녁, 디너, 이브닝

### 🍿 간식 (Snack)
**주요 키워드**: 견과류, 치즈, 올리브, 베리
**조리법**: 구이, 볶음
**시간대**: 간식, 스낵, 애프터눈

## 📊 응답 형식
다음 JSON 형태로 응답해주세요:
```json
{
  "meal_strategies": {
    "breakfast": {
      "primary_keywords": ["주요 키워드들"],
      "secondary_keywords": ["보조 키워드들"],
      "cooking_methods": ["조리법들"],
      "time_keywords": ["시간대 키워드들"]
    },
    "lunch": { ... },
    "dinner": { ... },
    "snack": { ... }
  },
  "diversity_strategy": "다양성 확보 전략",
  "search_priority": ["검색 우선순위"]
}
```

### ⚠️ 주의사항
- {days}일간 중복 최소화를 위한 전략 수립
- 사용자 제약 조건 반영
- 검색 성공률 최대화
- 키토 식단 원칙 준수
"""

# 다른 접근법들
PROMPT = EMBEDDING_MEAL_PLAN_PROMPT
DEFAULT_PROMPT = EMBEDDING_MEAL_PLAN_PROMPT
