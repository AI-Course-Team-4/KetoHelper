"""
의도 분류 프롬프트
사용자 메시지를 분석하여 의도를 분류
"""

INTENT_CLASSIFICATION_PROMPT = """
사용자 메시지를 분석하여 의도를 분류하세요.

사용자 메시지: "{message}"

다음 JSON 형태로 **정확히** 응답하세요:
{{
    "intent": "meal_planning",
    "confidence": 0.9,
    "reasoning": "분류 이유"
}}

**중요**: intent 값은 반드시 다음 중 하나여야 합니다:
- "recipe_search" (레시피/조리법 요청)
- "meal_plan" (식단표/식단 계획 요청)
- "place_search" (식당 검색 요청)  
- "calendar_save" (캘린더 저장 요청)
- "general" (일반 대화)

의도 분류 기준 (중요!):
- recipe_search: 레시피, 요리법 **생성/만들기** 요청
  예: "불고기 레시피", "계란말이 만드는 법", "키토 레시피 알려줘"
- meal_plan: 식단표, 식단 계획 **생성/만들기** 요청  
  예: "7일 식단표 만들어줘", "이번 주 메뉴 계획", "키토 식단표", "일주일 식단"
  
- place_search: 식당을 **찾기/검색** 요청
  예: "강남역 근처 식당", "키토 식당 찾아줘", "배달 가능한 곳", "맛집 추천해줘"
  
- calendar_save: **이미 만든 식단을 캘린더에 저장/등록** 요청
  예: "캘린더에 저장해줘", "일정으로 등록", "일정 추가", "재등록", "타이틀은 ~로 해줘", "메모에 ~ 첨부해서 저장"
  
- general: 질문, 인사, 일반 대화, 기억 요청, 알레르기/선호도 설정
  예: "키토 다이어트가 뭐야?", "안녕", "고마워", "브로콜리 싫어해", "우유 소화 안돼"

**핵심 판단 기준:**
1. **CALENDAR_SAVE**: "저장", "등록", "추가", "재등록", "타이틀", "메모" + 식단 관련 맥락
2. **RECIPE_SEARCH**: "짜줘", "만들어줘", "계획해줘" + 식단/레시피 관련  
   → "이번 주 7일 코스 키토 식단 짜줄래?" = RECIPE_SEARCH (식단 짜줘)
3. **PLACE_SEARCH**: "찾아줘", "추천해줘", "어디있어" + 장소 관련
4. **GENERAL**: 순수 질문형("뭐야?", "어떻게?", "왜?") + 인사 + 기억 요청

**중요**: 
- "짜줘", "만들어줘", "계획해줘"가 있으면 RECIPE_SEARCH 우선 고려
- 질문형이어도 구체적 요청("짜줄래?")이 있으면 해당 의도로 분류
- 문맥을 정확히 파악하여 분류하세요.
"""

def get_intent_prompt(message: str) -> str:
    """
    의도 분류 프롬프트 반환
    
    Args:
        message: 사용자 메시지
    
    Returns:
        완성된 프롬프트 문자열
    """
    return INTENT_CLASSIFICATION_PROMPT.format(message=message)
