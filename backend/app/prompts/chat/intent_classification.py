"""
의도 분류 프롬프트
사용자 메시지를 분석하여 의도를 분류
"""

INTENT_CLASSIFICATION_PROMPT = """
사용자 메시지를 분석하여 의도를 분류하세요.

사용자 메시지: "{message}"

다음 JSON 형태로 응답하세요:
{{
    "intent": "meal_plan",
    "confidence": 0.9,
    "reasoning": "분류 이유"
}}

**분류 규칙 (우선순위 순서):**

1. **캘린더 저장 = calendar_save** (최우선 - 다른 키워드와 함께 나와도 우선)
   - "캘린더", "일정", "저장", "등록", "추가", "넣어줘", "반영", "업데이트" 등의 행동 키워드
   - "식단을 캘린더에 추가" → calendar_save (식단+캘린더)
   - "내일 아침 메뉴 일정으로 저장해줘" → calendar_save (메뉴+일정+저장)
   - "주중 식단 전체를 한 번에 일정화" → calendar_save (식단+일정화)
   - "다음 주 5일 점심만 캘린더 반영" → calendar_save (점심+캘린더)

2. **개별 레시피/요리법 = recipe_search** (단일 음식/요리 관련)
   - **핵심**: 하나의 특정 음식/요리에 대한 정보 요청
   - "레시피", "조리법", "만드는 법", "비법", "온도", "드레싱", "소스", "바꿔줘", "대체", "제외" 등
   - 단일 재료나 요리 이름이 나오면 대부분 recipe_search
   - "닭가슴살 수비드 최적 온도 알려줘" → recipe_search (단일 요리)
   - "두부 스테이크 겉바속촉 비법" → recipe_search (단일 요리)
   - "아보카도 참치 샐러드 드레싱" → recipe_search (단일 요리)
   - "콜리플라워 라이스 볶음밥 레시피" → recipe_search (단일 요리)
   - "버터 대신 올리브유 버전으로 바꿔줘" → recipe_search (재료 변경)
   - "오트는 제외, 대체 재료 추천" → recipe_search (재료 변경)

3. **식당 검색 = place_search**
   - "식당", "맛집", "근처", "추천", "~에서", "~역" 등 장소 키워드
   - "강남역 근처 식당" → place_search
   - "역세권 5분 내 저탄수 식당" → place_search

4. **식단표 생성 = meal_plan** (여러 끼/여러 날의 계획)
   - **핵심**: 여러 날에 걸친 식사 계획이나 여러 끼를 묶어서 요청
   - "식단표", "식단 구성", "일주일", "3일", "7일", "N끼", "아침+점심+저녁" 등 복수 표현
   - **주의**: 단일 요리는 절대 meal_plan이 아님!
   - "7일 키토 식단표 만들어줘" → meal_plan (7일간 계획)
   - "일주일 아침 점심 구성" → meal_plan (여러 끼)
   - "출근용 도시락 위주로 2주 식단" → meal_plan (2주간 계획)

5. **일반 대화/프로필 메모 = general**
   - 취향, 선호도, 알레르기 등 개인정보 저장 요청
   - 일반적인 대화나 질문
   - "버섯은 싫어하니 빼줘, 기억해" → general
   - "달걀 알레르기 있어, 메모 부탁" → general
   - "내 취향 요약해서 저장해줘" → general

**중요: 키워드가 겹치는 경우 위 순서대로 우선순위를 적용하세요.**

"""

def get_intent_prompt(message: str) -> str:
    """의도 분류 프롬프트 생성"""
    return INTENT_CLASSIFICATION_PROMPT.format(message=message)