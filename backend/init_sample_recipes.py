"""
ChromaDBì— ìƒ˜í”Œ í‚¤í†  ë ˆì‹œí”¼ ë°ì´í„° ì´ˆê¸°í™”
"""
import asyncio
from app.tools.recipe_rag import RecipeRAGTool

async def init_sample_data():
    """ìƒ˜í”Œ í‚¤í†  ë ˆì‹œí”¼ ë°ì´í„° ì¶”ê°€"""
    
    rag_tool = RecipeRAGTool()
    
    sample_recipes = [
        {
            "id": "keto_001",
            "title": "í‚¤í†  ê¹€ì¹˜ë³¶ìŒë°¥",
            "ingredients": [
                {"name": "ì½œë¦¬í”Œë¼ì›Œ ë¼ì´ìŠ¤", "amount": 200, "unit": "g"},
                {"name": "ê¹€ì¹˜", "amount": 100, "unit": "g"},
                {"name": "ë¼ì§€ê³ ê¸°", "amount": 80, "unit": "g"},
                {"name": "ë‹¬ê±€", "amount": 2, "unit": "ê°œ"},
                {"name": "ì½”ì½”ë„›ì˜¤ì¼", "amount": 1, "unit": "í°ìˆ "},
                {"name": "ëŒ€íŒŒ", "amount": 1, "unit": "ëŒ€"}
            ],
            "steps": [
                "ì½œë¦¬í”Œë¼ì›Œë¥¼ ìŒ€ì•Œ í¬ê¸°ë¡œ ë‹¤ì§„ë‹¤",
                "íŒ¬ì— ì½”ì½”ë„›ì˜¤ì¼ì„ ë‘ë¥´ê³  ë¼ì§€ê³ ê¸°ë¥¼ ë³¶ëŠ”ë‹¤",
                "ê¹€ì¹˜ë¥¼ ë„£ê³  í•¨ê»˜ ë³¶ëŠ”ë‹¤",
                "ì½œë¦¬í”Œë¼ì›Œ ë¼ì´ìŠ¤ë¥¼ ë„£ê³  ë³¶ëŠ”ë‹¤",
                "ë‹¬ê±€ì„ í’€ì–´ë„£ê³  ì„ëŠ”ë‹¤",
                "ëŒ€íŒŒë¥¼ ì˜¬ë ¤ ì™„ì„±"
            ],
            "tips": [
                "ì½œë¦¬í”Œë¼ì›ŒëŠ” ìˆ˜ë¶„ì„ ì¶©ë¶„íˆ ì œê±°í•´ì•¼ í•©ë‹ˆë‹¤",
                "ê¹€ì¹˜ëŠ” ì‹ ë§›ì´ ê°•í•œ ê²ƒì„ ì‚¬ìš©í•˜ì„¸ìš”"
            ],
            "macros": {"kcal": 320, "carb": 8, "protein": 22, "fat": 24},
            "tags": ["í‚¤í† ", "í•œì‹", "ë³¶ìŒë°¥", "ì €íƒ„ìˆ˜"],
            "ketoized": True,
            "allergen_flags": ["ë‹¬ê±€"]
        },
        {
            "id": "keto_002", 
            "title": "í‚¤í†  ì‚¼ê²¹ì‚´ ìƒì¶”ìŒˆ",
            "ingredients": [
                {"name": "ì‚¼ê²¹ì‚´", "amount": 200, "unit": "g"},
                {"name": "ìƒì¶”", "amount": 10, "unit": "ì¥"},
                {"name": "ê¹»ì", "amount": 5, "unit": "ì¥"},
                {"name": "ë§ˆëŠ˜", "amount": 3, "unit": "ìª½"},
                {"name": "ì•„ë³´ì¹´ë„", "amount": 0.5, "unit": "ê°œ"},
                {"name": "ì˜¬ë¦¬ë¸Œì˜¤ì¼", "amount": 1, "unit": "í°ìˆ "}
            ],
            "steps": [
                "ì‚¼ê²¹ì‚´ì„ êµ¬ì›Œë‚¸ë‹¤",
                "ë§ˆëŠ˜ì€ í¸ìœ¼ë¡œ ì¬ë‹¤",
                "ì•„ë³´ì¹´ë„ëŠ” ìŠ¬ë¼ì´ìŠ¤í•œë‹¤",
                "ìƒì¶”ì™€ ê¹»ìì„ ì¤€ë¹„í•œë‹¤",
                "êµ¬ìš´ ì‚¼ê²¹ì‚´ì„ ìƒì¶”ì— ì‹¸ì„œ ë¨¹ëŠ”ë‹¤"
            ],
            "tips": [
                "ì‚¼ê²¹ì‚´ì€ ê¸°ë¦„ê¸°ë¥¼ ì¶©ë¶„íˆ ë¹¼ê³  êµ¬ìš°ì„¸ìš”",
                "ì•„ë³´ì¹´ë„ëŠ” ìµì€ ê²ƒì„ ì‚¬ìš©í•˜ì„¸ìš”"
            ],
            "macros": {"kcal": 450, "carb": 6, "protein": 28, "fat": 38},
            "tags": ["í‚¤í† ", "í•œì‹", "êµ¬ì´", "ì €íƒ„ìˆ˜"],
            "ketoized": True,
            "allergen_flags": []
        },
        {
            "id": "keto_003",
            "title": "í‚¤í†  ì•„ë³´ì¹´ë„ ì¹˜ì¦ˆ ìƒëŸ¬ë“œ",
            "ingredients": [
                {"name": "ì•„ë³´ì¹´ë„", "amount": 1, "unit": "ê°œ"},
                {"name": "ëª¨ì§œë ë¼ ì¹˜ì¦ˆ", "amount": 100, "unit": "g"},
                {"name": "ë°©ìš¸í† ë§ˆí† ", "amount": 5, "unit": "ê°œ"},
                {"name": "ì˜¬ë¦¬ë¸Œì˜¤ì¼", "amount": 2, "unit": "í°ìˆ "},
                {"name": "ë ˆëª¬ì¦™", "amount": 1, "unit": "í°ìˆ "},
                {"name": "ì†Œê¸ˆ", "amount": 0.5, "unit": "ì‘ì€ìˆ "}
            ],
            "steps": [
                "ì•„ë³´ì¹´ë„ë¥¼ í¼ì§í•˜ê²Œ ì¬ë‹¤",
                "ëª¨ì§œë ë¼ ì¹˜ì¦ˆë¥¼ í•œì… í¬ê¸°ë¡œ ìë¥¸ë‹¤",
                "ë°©ìš¸í† ë§ˆí† ë¥¼ ë°˜ìœ¼ë¡œ ìë¥¸ë‹¤",
                "ì˜¬ë¦¬ë¸Œì˜¤ì¼ê³¼ ë ˆëª¬ì¦™ì„ ì„ì–´ ë“œë ˆì‹±ì„ ë§Œë“ ë‹¤",
                "ëª¨ë“  ì¬ë£Œë¥¼ ì„ê³  ë“œë ˆì‹±ì„ ë¿Œë¦°ë‹¤"
            ],
            "tips": [
                "ì•„ë³´ì¹´ë„ëŠ” ë„ˆë¬´ ìµì§€ ì•Šì€ ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤",
                "ë“œë ˆì‹±ì€ ë¨¹ê¸° ì§ì „ì— ë¿Œë¦¬ì„¸ìš”"
            ],
            "macros": {"kcal": 380, "carb": 12, "protein": 18, "fat": 32},
            "tags": ["í‚¤í† ", "ìƒëŸ¬ë“œ", "ì¹˜ì¦ˆ", "ì €íƒ„ìˆ˜"],
            "ketoized": True,
            "allergen_flags": ["ìœ ì œí’ˆ"]
        },
        {
            "id": "keto_004",
            "title": "í‚¤í†  ë‹­ê°€ìŠ´ì‚´ ë²„í„°êµ¬ì´",
            "ingredients": [
                {"name": "ë‹­ê°€ìŠ´ì‚´", "amount": 200, "unit": "g"},
                {"name": "ë²„í„°", "amount": 2, "unit": "í°ìˆ "},
                {"name": "ë¡œì¦ˆë§ˆë¦¬", "amount": 1, "unit": "ê°€ì§€"},
                {"name": "ë§ˆëŠ˜", "amount": 2, "unit": "ìª½"},
                {"name": "ì†Œê¸ˆ", "amount": 0.5, "unit": "ì‘ì€ìˆ "},
                {"name": "í›„ì¶”", "amount": 0.3, "unit": "ì‘ì€ìˆ "}
            ],
            "steps": [
                "ë‹­ê°€ìŠ´ì‚´ì— ì†Œê¸ˆê³¼ í›„ì¶”ë¡œ ë°‘ê°„í•œë‹¤",
                "íŒ¬ì— ë²„í„°ë¥¼ ë…¹ì¸ë‹¤",
                "ë§ˆëŠ˜ê³¼ ë¡œì¦ˆë§ˆë¦¬ë¥¼ ë„£ê³  í–¥ì„ ë‚¸ë‹¤",
                "ë‹­ê°€ìŠ´ì‚´ì„ ë„£ê³  êµ¬ì›Œë‚¸ë‹¤",
                "ë²„í„° ì†ŒìŠ¤ë¥¼ ë¼ì–¹ì–´ ì™„ì„±"
            ],
            "tips": [
                "ë‹­ê°€ìŠ´ì‚´ì€ ë„ˆë¬´ ì˜¤ë˜ êµ½ì§€ ë§ˆì„¸ìš”",
                "ë²„í„° í–¥ì´ ë‚ ì•„ê°€ì§€ ì•Šë„ë¡ ì£¼ì˜í•˜ì„¸ìš”"
            ],
            "macros": {"kcal": 340, "carb": 2, "protein": 35, "fat": 22},
            "tags": ["í‚¤í† ", "ë‹­ê³ ê¸°", "êµ¬ì´", "ì €íƒ„ìˆ˜"],
            "ketoized": True,
            "allergen_flags": ["ìœ ì œí’ˆ"]
        },
        {
            "id": "keto_005",
            "title": "í‚¤í†  ì½”ì½”ë„› ì»¤í”¼",
            "ingredients": [
                {"name": "ë¸”ë™ì»¤í”¼", "amount": 1, "unit": "ì»µ"},
                {"name": "ì½”ì½”ë„›ì˜¤ì¼", "amount": 1, "unit": "í°ìˆ "},
                {"name": "ë²„í„°", "amount": 1, "unit": "í°ìˆ "},
                {"name": "ì—ë¦¬ìŠ¤ë¦¬í†¨", "amount": 1, "unit": "ì‘ì€ìˆ "}
            ],
            "steps": [
                "ëœ¨ê±°ìš´ ë¸”ë™ì»¤í”¼ë¥¼ ì¤€ë¹„í•œë‹¤",
                "ì½”ì½”ë„›ì˜¤ì¼ê³¼ ë²„í„°ë¥¼ ë„£ëŠ”ë‹¤",
                "ì—ë¦¬ìŠ¤ë¦¬í†¨ì„ ë„£ëŠ”ë‹¤",
                "ë¯¹ì„œê¸°ë¡œ 30ì´ˆê°„ ë¸”ë Œë”©í•œë‹¤",
                "ê±°í’ˆì´ ìƒê¸°ë©´ ì™„ì„±"
            ],
            "tips": [
                "ë¸”ë Œë”©í•  ë•Œ ëšœê»‘ì„ ê¼­ ë‹«ìœ¼ì„¸ìš”",
                "ëœ¨ê±°ìš¸ ë•Œ ë§ˆì…”ì•¼ ë§›ìˆìŠµë‹ˆë‹¤"
            ],
            "macros": {"kcal": 200, "carb": 1, "protein": 1, "fat": 22},
            "tags": ["í‚¤í† ", "ìŒë£Œ", "ì»¤í”¼", "ì €íƒ„ìˆ˜"],
            "ketoized": True,
            "allergen_flags": ["ìœ ì œí’ˆ"]
        }
    ]
    
    print("ğŸš€ ìƒ˜í”Œ í‚¤í†  ë ˆì‹œí”¼ ë°ì´í„° ì´ˆê¸°í™”ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...")
    
    for recipe in sample_recipes:
        try:
            recipe_id = await rag_tool.add_recipe_to_vector_store(recipe)
            if recipe_id:
                print(f"âœ… '{recipe['title']}' ì¶”ê°€ ì™„ë£Œ (ID: {recipe_id})")
            else:
                print(f"âŒ '{recipe['title']}' ì¶”ê°€ ì‹¤íŒ¨")
        except Exception as e:
            print(f"âŒ '{recipe['title']}' ì¶”ê°€ ì¤‘ ì˜¤ë¥˜: {e}")
    
    # í†µê³„ í™•ì¸
    stats = rag_tool.vector_store.get_collection_stats()
    print(f"\nğŸ“Š ChromaDB í†µê³„:")
    print(f"   - ì»¬ë ‰ì…˜ ì´ë¦„: {stats['collection_name']}")
    print(f"   - ì´ ë¬¸ì„œ ìˆ˜: {stats['document_count']}")
    
    print("\nğŸ‰ ìƒ˜í”Œ ë°ì´í„° ì´ˆê¸°í™” ì™„ë£Œ!")

if __name__ == "__main__":
    asyncio.run(init_sample_data())
